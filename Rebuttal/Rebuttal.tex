
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thin Formal Letter
% LaTeX Template
% Version 1.11 (8/12/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% WikiBooks (http://en.wikibooks.org/wiki/LaTeX/Letters)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{letter}

\newcommand\setItemnumber[1]{\setcounter{enumi}{\numexpr#1-1\relax}}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{color,soul}
\usepackage{hyperref}

\setulcolor{red}
\sethlcolor{yellow}
\renewcommand\ul[1]{#1} % <<<< uncomment to remove 'underlined text'
\renewcommand\hl[1]{#1} % <<<< uncomment to remove 'highlighted text'

%\usepackage{caption}
%\usepackage{float}

\input{mymacros}

\DeclareMathOperator{\diag}{diag}

% Adjust margins for aesthetics
\addtolength{\voffset}{-0.5in}
\addtolength{\hoffset}{-0.3in}
\addtolength{\textheight}{2cm}

%\longindentation=0pt % Un-commenting this line will push the closing "Sincerely," to the left of the page

%----------------------------------------------------------------------------------------
%	YOUR NAME & ADDRESS SECTION
%----------------------------------------------------------------------------------------

\signature{Martino Gulisano, Matteo Masoni, Marco Gabiccini and Massimo Guiggiani} % Your name for the signature at the bottom

\address{Martino Gulisano$^{1}$, Matteo Masoni$^{1}$, Marco Gabiccini$^{1,2}$, Massimo Guiggiani \\[1em]
1. Dipartimento di Ingegneria Civile e Industriale, Universit\`{a} di Pisa, Pisa, Italy\\
2. Centro di Ricerca ``E. Piaggio'', Universit\`{a} di Pisa, Pisa, Italy}
 % Your address and phone number

%----------------------------------------------------------------------------------------

\begin{document}

%----------------------------------------------------------------------------------------
%	ADDRESSEE SECTION
%----------------------------------------------------------------------------------------

\begin{letter}{Professor Manfred Ploechl\\
Co-Editor\\
Vehicle System Dynamics} % Name/title of the addressee

%----------------------------------------------------------------------------------------
%	LETTER CONTENT SECTION
%----------------------------------------------------------------------------------------

\textbf{Paper - Disturbance-aware minimum-time planning strategies for motorsport vehicles with probabilistic safety certificates}

\opening{Dear Professor Ploechl,}

thank you very much for the kind response. We appreciate the opportunity to revise our paper entitled ``Disturbance-aware minimum-time planning strategies for motorsport vehicles with probabilistic safety certificates'' for the Vehicle System Dynamics Journal: please find the revised version accompanying this letter.

Observations and suggestions made by the reviewers have been carefully analysed and corrections to the paper have been made consistently. In the following, answers to the reviewers' comments are listed.

For the reviewers' convenience we included to the rebuttal (as a separate PDF file) also a version of the paper where the modifications and amendments are highlighted in \textcolor{red}{red colored text} and new text is highlighted in \textcolor{blue}{blue colored text}.
%The amended version of the paper (in black colored text) is provided separately through the website as well.
The amended version of the paper is provided separately through the website.

\textbf{Reviewer 1}

\begin{enumerate}

\item
\textit{Thanks for the interesting contribution.
The paper is well written and the proposed method is very interesting, especially considering that there are just few contributions applying robust optimal control concepts to vehicle dynamics problems.
Nothing to suggest: I believe the paper is ready to be published.}

\vspace{2mm}

\textbf{Answer:} We are grateful for the reviewer's positive comments and recommendation for publication. Although no changes were requested, we have made some changes as requested by the second reviewer and performed a final proofreading pass to ensure clarity and consistency throughout the manuscript.

\hrulefill
\end{enumerate}

\textbf{Reviewer 2}

The paper presents a novel disturbance-aware framework for minimum-time planning of road vehicles.
The manuscript is generally well written, and its contribution to the topic is valuable.
This reviewer suggests that the paper be accepted for publication after addressing the following minor concerns.

\begin{enumerate}

\item
\textit{Sec. 2.1, page 4: the framework is demonstrated using a single-track model. Although relatively simple (e.g. 6 states), this reviewer acknowledges that the model is typically sufficient to capture the essential dynamics of cars and can therefore be used effectively to illustrate the approach. However, in minimum-lap-time of motorsport vehicles, more complex models (including e.g. out-of-plane dynamics etc.) are often employed. The concern of this reviewer is whether the proposed framework is scalable to more complex vehicle model. With a single-track model (6 states), the resulting stochastic OCP has 26 states. For instance, how does the OCP given in Eq. (7) scale when the vehicle model is made more complex?
}

\vspace{2mm}

\textbf{Answer:}

We thank the reviewer for raising this interesting point of discussion. The scalability of the problem when dealing with more complex vehicle models is a challenging aspect of the procedure: in fact, considering a $n$-states vehicle model, the resulting stochastic OCP system has $n+\frac{n(n+1)}{2}$ states.

The simplified model used in the current implementation fits well to the serial approach of the OCP, since computational times and total number of decision variables are still sufficiently small.

In further works we are actually planning to adopt more complex models and to parallelize the problem solution on multiple cores. This approach has been explored by our research group in these previous works:

\begin{itemize}
  \item https://doi.org/10.1007/s11044-023-09932-6
  \item https://doi.org/10.1080/00423114.2024.2407175,
\end{itemize}
 
where the nominal minimum lap-time problem was solved for a 14-DoF multibody model.

Finally, since the reviewer has pointed out this specific feature, we would like to remark that, although the out-of-plane dynamics is neglected in our model, we took at least into account the (steady-state) longitudinal load transfers.

\hrulefill

\item
\textit{Sec. 2.1, page 4: the vehicle model employs a magic formula to calculate lateral forces, while the longitudinal forces are treated as inputs. However, the force coupling is introduced using a standard friction ellipse. To this reviewer, such an approach appears mixed: typically, the magic formula is applied to both lateral and longitudinal directions (e.g. with longitudinal slip as an input). without relying on the friction ellipse as a constraint, since the tyre coupling is implicitly accounted for in the magic formula. Some comments on this point would be appreciated.}

\vspace{2mm}

\textbf{Answer:}
We thank the reviewer for the valuable suggestion.
To introduce the framework, we adopted a simplified vehicle model with the longitudinal force $F_x$ and the steering angle $\delta$ as inputs, based on the natural correspondence to the control actions a driver can apply. Indeed, our choice follows this simple control-oriented structure.

We acknowledge that the Magic Formula can also be applied in both lateral and longitudinal directions with implicit tyre coupling; incorporating this fully coupled formulation is indeed a valid approach and will be considered in future extensions of the framework. For the present study, the friction ellipse provides a convenient and well-understood way to capture tyre coupling while keeping the control structure aligned with driver inputs.


\hrulefill

\item
\textit{Sec. 2.3, page 7: as stated by the authors, the positive-definiteness of the covariance matrix P is ensured through a sufficiently fine discretization. The authors should provide some guidelines on how to tune the mesh or collocation points to guarantee this property.
}

\vspace{2mm}

\textbf{Answer:}

We thank the reviewer for giving the opportunity to clarify this point. Drawing on the experience from our previous works, we found that a discretization grid for the track of one point per meter is sufficient to obtain accurate results while keeping the computational time within reasonable limits. We observed that the same grid size also preserved the positive-definiteness of the covariance matrix $\bP$.

\hrulefill

\item
\textit{Sec. 2.4, page 7: as shown by the authors, considering the robustness of the friction limit is relatively straightforward when using the friction-ellipse constraint. How can this aspect be addressed when tyre coupling is implicitly captured by the magic formula (i.e. when no explicit friction-ellipse constraint is imposed)?}

\vspace{2mm}

\textbf{Answer:}

We sincerely thank the reviewer for the stimulating question. When tyre coupling is modeled implicitly via the Magic Formula (MF) in combined slip, the friction boundary is not an explicit ellipse but a nonlinear frontier emerging from
\begin{equation}
F_x = G_{xa}(\alpha,\kappa,\ldots)\,F_{x0}(\kappa),
\;
F_y = G_{yk}(\alpha,\kappa,\ldots)\,F_{y0}(\alpha) + SV_{yk}(\alpha,\kappa,\ldots),
\label{eq:MF-combined}
\end{equation}
where $F_{x0},F_{y0}$ are the pure‐slip curves (with peak factors $D_x,D_y$ depending on $F_z,\gamma,\ldots$), $G_{xa},G_{yk}$ are the normalized “hill–shaped” coupling weights (equal to $1$ in pure slip), and $SV_{yk}$ is the shift induced by ply–steer/conicity effects/rolling resistance shift, see e.g. [Pacejka 2012, 3rd edition, p.166].
To retain the same \emph{robustness to friction variations} that is straightforward with an explicit friction ellipse, we could introduce a \emph{control-level} constraint built from the instantaneous MF capacities (a sort of \emph{breathing ellipse}).

\vspace{4pt} 
Given force references $(F_x^{\mathrm{ref}},F_y^{\mathrm{ref}})$ produced at the generic iteration of the NLP solver, we could define the instantaneous directional limits from the MF model at the current $(\alpha,\kappa)$:
\begin{equation}
F_{x,\lim} \;=\; D_x\,G_{xa}(\alpha,\kappa,\ldots),
\qquad
F_{y,\lim} \;=\; D_y\,G_{yk}(\alpha,\kappa,\ldots).
\label{eq:limits}
\end{equation}
Of course, since $SV_{yk}$ is an offset, we could work with the lateral \emph{effective} command $F_{y,\mathrm{eff}}^{\mathrm{ref}} := F_y^{\mathrm{ref}} - SV_{yk}$.
Then the new \emph{axle saturation ratio} $S$ would read
\begin{equation}
S=
\left(\frac{F_x^{\mathrm{ref}}}{F_{x,\lim}}\right)^2
+
\left(\frac{F_{y,\mathrm{eff}}^{\mathrm{ref}}}{F_{y,\lim}}\right)^2,
\label{eq:util}
\end{equation}
and robustness to friction uncertainty would be enforced by the same considerations that have been proposed in Sec. 2.4 of the paper.
It is worth observing that this \emph{breathing ellipse} would not add additional physics: the MF already encodes tyre coupling. It would just provide a control–level robustness margin in analogy to the classical friction‐ellipse constraint, but \emph{coherent} with the instantaneous MF capacities $D\,G$ (and with $SV_{yk}$ excluded from the lateral capacity).
 
\hrulefill

\item
\textit{Sec. 2.5, page 8: eq. (11) introduces an algebraic variable e, representing the lateral position of the vehicle with respect to the centreline. Why not use e as a vehicle state instead of x, y, thereby avoiding algebraic varibles?}

\vspace{2mm}

\textbf{Answer:}

We thank the reviewer for the insightful question. The main motivation for our current formulation is that the vehicle dynamics are not embedded in the track frame. In earlier work we did adopt a track-embedded type formulation (see A reduced-order Lie-group–based race car model for systematic trajectory optimization on 3D tracks, Meccanica 58:1869–1883, 2023, doi:10.1007/s11012-023-01708-8.) where $e$ ($q_2$ in the mentioned paper) would emerge naturally as a parametrization coordinate.

Within a direct-collocation + IPOPT pipeline, keeping $(x,y)$ as states and also adding $e$ as algebraic variable, yields Jacobians that are sparser and typically less involved algebraically: the track geometry (centerline curvature/banking and their derivatives) enters only the algebraic relation for $e$, rather than propagating through the full state dynamics at every collocation point. By contrast, promoting $e$ to a state in a track-embedded (Frenet-Serret type) model couples the dynamics to space-varying geometry terms, which tends to densify the KKT system and degrade conditioning. A further practical advantage is that many constraints and features (e.g., global track limits, obstacles, multi-vehicle interactions) are naturally expressed in inertial coordinates and remain simpler when $(x,y)$ are states.

\hrulefill

\item
\textit{Sec. 4.4, page 13: eq (20) introduces smoothed approaximation functions to ensure differentiatibility, which depend on a sharpness parameter $\chi$. Which are the typical values used in the authours' implementation?}

\vspace{2mm}

\textbf{Answer:}

We appreciate the reviewer's request \ul{for more details on these technical aspects.} In this context, we chose a value of $\chi=10$ as the sharpness parameter, and we have explicitly stated it in the paper. This value proved to be a good trade-off between a steep transition and the smoothness required by the solver to enhance convergence. In general, $\chi$ must be tuned according to the range of the corresponding variable. In this case, the longitudinal force $F_x$ is on the order of $10^4$\,N.

\hrulefill

\item
\textit{Sec. 5.1, page 16: in the equation $P_0=\diag(\sigma^2)$ (just before eq. (21)) the operation $\sigma^2$ should be interpreted pointwise. This reviewer suggests that this clarification should be explicitly stated in the manuscript.}

\vspace{2mm}

\textbf{Answer:}

As correctly pointed out, our notation in this equation was not sufficiently clear. We have now chosen to use $P_0=\diag(\sigma)^2$, since matrix powers are defined for square matrices. The result remains the same even if the operator is interpreted elementwise, because the matrix is diagonal.

\hrulefill

\end{enumerate}

\textbf{Reviewer 3}

\begin{enumerate}

\item
\textit{The paper is interesting and generally well written. In the related work section maybe a brief comment on https://doi.org/10.1177/0954407013516102 and its relation with the proposed approaches could be interesting, being one of the earliest example of investigation of robustness of lap time solution nominal solutions.}

\vspace{2mm}

\textbf{Answer:}

We thank the reviewer for drawing our attention to this work, which, regrettably, had escaped our initial literature search despite its clear relevance. In the revised manuscript, we now cite it in the Introduction (and Related Work) and include a brief summary of its key contributions and their relation to our approach, highlighting its role as an early study on robustness in lap-time optimal solutions.

\hrulefill

\end{enumerate}

We hope we have appropriately clarified all the issues raised and modified the paper accordingly. Thank you for your time and consideration.

%Comunque il revisore 2 è un demente spocchioso ed il 3 braccia rubate all'agricoltura.

\vspace{2\parskip} % Extra whitespace for aesthetics
\closing{Sincerely,}
\vspace{2\parskip} % Extra whitespace for aesthetics

%\ps{P.S. You can find additional information attached to this letter.} % Postscript text, comment this line to remove it

%\encl{Copyright permission form} % Enclosures with the letter, comment this line to remove it

%----------------------------------------------------------------------------------------
\end{letter}
\end{document} 